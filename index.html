
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>alimalik.design | Playground</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        :root {
            --wise-forest: #163300;
            --wise-bright: #9FE870;
            --wise-bg: #F2F5F7;
            --wise-white: #FFFFFF;
            --wise-stroke: #E2E6E9;
            --text-primary: #163300;
            --text-secondary: #5d676a;
            --code-gutter-bg: #F8F9FA;
            --code-num-color: #ADB5BD;
            --top-bar-height: 64px;
            --sidebar-width: 450px;
        }

        * { box-sizing: border-box; }
        body, html {
            height: 100%;
            margin: 0;
            font-family: 'Inter', sans-serif;
            background-color: var(--wise-bg);
            overflow: hidden;
        }

        /* --- TOP BAR --- */
        .top-bar {
            height: var(--top-bar-height);
            background: var(--wise-white);
            border-bottom: 1px solid var(--wise-stroke);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 24px;
            z-index: 100;
        }

        .brand { font-weight: 800; font-size: 1.1rem; color: var(--wise-forest); }

        .device-switcher {
            display: flex;
            gap: 4px;
            background: var(--wise-bg);
            padding: 4px;
            border-radius: 12px;
        }

        .device-btn {
            background: transparent;
            border: none;
            border-radius: 8px;
            padding: 6px 16px;
            font-size: 0.8rem;
            font-weight: 600;
            color: var(--text-secondary);
            cursor: pointer;
            transition: 0.2s;
        }

        .device-btn.active { background: var(--wise-forest); color: var(--wise-bright); }

        /* --- LAYOUT --- */
        .main-view { display: flex; height: calc(100vh - var(--top-bar-height)); }

        .sidebar {
            width: var(--sidebar-width);
            background: var(--wise-white);
            border-right: 1px solid var(--wise-stroke);
            display: flex;
            flex-direction: column;
            height: 100%;
        }

        .editor-section {
            display: flex;
            flex-direction: column;
            border-bottom: 1px solid var(--wise-stroke);
            overflow: hidden;
            transition: flex 0.3s ease;
        }

        .editor-section.expanded { flex: 1; }
        .editor-section.collapsed { flex: 0 0 52px; }

        .section-header {
            height: 52px;
            min-height: 52px;
            padding: 0 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
            background: white;
            z-index: 5;
        }

        .section-header h3 { font-size: 0.75rem; font-weight: 700; color: var(--text-secondary); margin: 0; }
        .chevron { transition: transform 0.3s; opacity: 0.5; }
        .expanded .chevron { transform: rotate(180deg); }

        /* --- CODE EDITOR ENGINE --- */
        .editor-wrapper {
            flex: 1;
            margin: 0 16px 16px 16px;
            border: 1px solid var(--wise-stroke);
            border-radius: 12px;
            background: white;
            display: flex;
            overflow: hidden;
            position: relative;
        }

        .gutter {
            width: 45px;
            background: var(--code-gutter-bg);
            border-right: 1px solid var(--wise-stroke);
            color: var(--code-num-color);
            font-family: 'Monaco', 'Menlo', monospace;
            font-size: 12px;
            padding: 24px 0;
            text-align: center;
            line-height: 22px; /* Must match textarea line-height */
            user-select: none;
            overflow: hidden;
        }

        .code-area {
            flex: 1;
            position: relative;
            overflow: hidden;
        }

        /* The layer that shows the colors */
        .highlight-layer {
            position: absolute;
            top: 0; left: 0;
            width: 100%; height: 100%;
            padding: 24px;
            margin: 0;
            font-family: 'Monaco', 'Menlo', monospace;
            font-size: 13px;
            line-height: 22px;
            white-space: pre;
            pointer-events: none;
            color: #333;
            overflow: hidden;
            z-index: 1;
        }

        /* The invisible textarea you actually type in */
        .code-textarea {
            width: 100%;
            height: 100%;
            padding: 24px;
            background: transparent;
            color: transparent;
            caret-color: var(--wise-forest);
            border: none;
            outline: none;
            resize: none;
            font-family: 'Monaco', 'Menlo', monospace;
            font-size: 13px;
            line-height: 22px;
            white-space: pre;
            position: relative;
            z-index: 2;
            overflow: auto;
        }

        /* Syntax Colors */
        .t-tag { color: #e06c75; }
        .t-attr { color: #d19a66; }
        .t-str { color: #98c379; }
        .t-com { color: #abb2bf; font-style: italic; }

        /* --- PREVIEW AREA (EDGE TO EDGE) --- */
        .preview-area {
            flex: 1;
            background: var(--wise-bg);
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
        }

        .iframe-container {
            background: white;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            max-width: 100%;
            max-height: 100%;
        }

        .mode-desktop { width: 100%; height: 100%; border: none; }
        .mode-tablet { 
            width: 768px; height: 90%; 
            border: 12px solid var(--wise-forest); 
            border-radius: 32px;
            box-shadow: 0 40px 100px rgba(0,0,0,0.1);
        }
        .mode-mobile { 
            width: 375px; height: 85%; 
            border: 12px solid var(--wise-forest); 
            border-radius: 32px;
            box-shadow: 0 40px 100px rgba(0,0,0,0.1);
        }

        iframe { width: 100%; height: 100%; border: none; display: block; }
    </style>
</head>
<body>

    <header class="top-bar">
        <div class="brand">alimalik.design</div>
        <div class="device-switcher">
            <button class="device-btn active" onclick="setMode('desktop', this)">Desktop</button>
            <button class="device-btn" onclick="setMode('tablet', this)">Tablet</button>
            <button class="device-btn" onclick="setMode('mobile', this)">Mobile</button>
        </div>
        <div style="width: 120px"></div>
    </header>

    <div class="main-view">
        <aside class="sidebar">
            <!-- HTML Section -->
            <div id="sec-html" class="editor-section expanded">
                <div class="section-header" onclick="toggleSection('sec-html')">
                    <h3>HTML</h3>
                    <svg class="chevron" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3"><polyline points="6 9 12 15 18 9"></polyline></svg>
                </div>
                <div class="editor-wrapper">
                    <div id="gutter-html" class="gutter">1</div>
                    <div class="code-area">
                        <pre id="high-html" class="highlight-layer"></pre>
                        <textarea id="html-editor" class="code-textarea" spellcheck="false" oninput="onCodeInput('html')" onscroll="onCodeScroll('html')" placeholder="Enter HTML..."></textarea>
                    </div>
                </div>
            </div>

            <!-- CSS Section -->
            <div id="sec-css" class="editor-section collapsed">
                <div class="section-header" onclick="toggleSection('sec-css')">
                    <h3>CSS</h3>
                    <svg class="chevron" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3"><polyline points="6 9 12 15 18 9"></polyline></svg>
                </div>
                <div class="editor-wrapper">
                    <div id="gutter-css" class="gutter">1</div>
                    <div class="code-area">
                        <pre id="high-css" class="highlight-layer"></pre>
                        <textarea id="css-editor" class="code-textarea" spellcheck="false" oninput="onCodeInput('css')" onscroll="onCodeScroll('css')" placeholder="Enter CSS..."></textarea>
                    </div>
                </div>
            </div>

            <!-- JS Section -->
            <div id="sec-js" class="editor-section collapsed">
                <div class="section-header" onclick="toggleSection('sec-js')">
                    <h3>JS</h3>
                    <svg class="chevron" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3"><polyline points="6 9 12 15 18 9"></polyline></svg>
                </div>
                <div class="editor-wrapper">
                    <div id="gutter-js" class="gutter">1</div>
                    <div class="code-area">
                        <pre id="high-js" class="highlight-layer"></pre>
                        <textarea id="js-editor" class="code-textarea" spellcheck="false" oninput="onCodeInput('js')" onscroll="onCodeScroll('js')" placeholder="Enter JS..."></textarea>
                    </div>
                </div>
            </div>
        </aside>

        <main class="preview-area">
            <div id="iframe-container" class="iframe-container mode-desktop">
                <iframe id="preview-frame"></iframe>
            </div>
        </main>
    </div>

    <script>
        // --- SYNTAX HIGHLIGHTING ENGINE ---
        function highlight(code, lang) {
            // Escape HTML
            let escaped = code.replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;");
            
            if (lang === 'html') {
                return escaped
                    .replace(/(&lt;!--.*?--&gt;)/g, '<span class="t-com">$1</span>')
                    .replace(/(&lt;\/?[a-z1-6]+)/gi, '<span class="t-tag">$1</span>')
                    .replace(/([a-z-]+)=/gi, '<span class="t-attr">$1</span>=')
                    .replace(/"(.*?)"/g, '<span class="t-str">"$1"</span>');
            }
            if (lang === 'css' || lang === 'js') {
                return escaped
                    .replace(/(\/\*.*?\*\/|\/\/.*?\n)/g, '<span class="t-com">$1</span>')
                    .replace(/"(.*?)"|'(.*?)'/g, '<span class="t-str">"$1$2"</span>');
            }
            return escaped;
        }

        // --- CORE EDITOR FUNCTIONS ---
        function onCodeInput(lang) {
            const textarea = document.getElementById(`${lang}-editor`);
            const highLayer = document.getElementById(`high-${lang}`);
            const gutter = document.getElementById(`gutter-${lang}`);

            // Update Highlight
            highLayer.innerHTML = highlight(textarea.value, lang) + "\n";

            // Update Gutter Numbers
            const lineCount = textarea.value.split('\n').length;
            let numbers = "";
            for (let i = 1; i <= lineCount; i++) { numbers += i + "<br>"; }
            gutter.innerHTML = numbers;

            updatePreview();
        }

        function onCodeScroll(lang) {
            const textarea = document.getElementById(`${lang}-editor`);
            const highLayer = document.getElementById(`high-${lang}`);
            const gutter = document.getElementById(`gutter-${lang}`);

            // Sync horizontal and vertical scroll
            highLayer.scrollTop = textarea.scrollTop;
            highLayer.scrollLeft = textarea.scrollLeft;
            gutter.scrollTop = textarea.scrollTop;
        }

        // --- UI LOGIC ---
        function toggleSection(id) {
            const section = document.getElementById(id);
            section.classList.toggle('expanded');
            section.classList.toggle('collapsed');
            
            // Fallback: If everything is closed, open HTML
            const expanded = document.querySelectorAll('.expanded').length;
            if (expanded === 0) {
                document.getElementById('sec-html').classList.replace('collapsed', 'expanded');
            }
        }

        function setMode(mode, btn) {
            const container = document.getElementById('iframe-container');
            container.className = 'iframe-container mode-' + mode;
            document.querySelectorAll('.device-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
        }

        function updatePreview() {
            const html = document.getElementById('html-editor').value;
            const css = document.getElementById('css-editor').value;
            const js = document.getElementById('js-editor').value;
            const frame = document.getElementById('preview-frame');

            const source = `
                <!DOCTYPE html>
                <html>
                    <head>
                        <meta charset="UTF-8">
                        <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap" rel="stylesheet">
                        <script src="https://cdn.tailwindcss.com"><\/script>
                        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
                        <style>body{font-family:'Inter',sans-serif;margin:0;padding:0;background:#fff;}${css}</style>
                    </head>
                    <body>
                        ${html}
                        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"><\/script>
                        <script>try{${js}}catch(e){console.error(e)}<\/script>
                    </body>
                </html>
            `;
            frame.srcdoc = source;
        }

        // Initialize empty state
        window.onload = () => {
            onCodeInput('html');
            onCodeInput('css');
            onCodeInput('js');
        };
    </script>
</body>
</html>
